
\typeout{}\typeout{If latex fails to find aiaa-tc, read the README file!}
%


\documentclass[]{aiaa-tc}% insert '[draft]' option to show overfull boxes


\usepackage{amsmath}          % for formula writing (i.e. 'split', etc)
\usepackage{rotate}           %rotate/mirror images
\usepackage{cancel}           %draw lines through math to show "goes to zero"
\usepackage{xfrac}            %allows slated and side fractions
\usepackage{subcaption}       %allows captioning individual subfigures
\usepackage{multicol}         %enable environment with multiple columns
\usepackage[mode=buildnew]{standalone}% requires -shell-escape
  % compile with `pdflatex -shell-escape main` or `xelatex  -shell-escape main`


\usepackage{tikz}             %for creating vector graphics diagrams
\usetikzlibrary{backgrounds}  %put backgrounds behind tikz figures
\usetikzlibrary{calc}         %perform calculations within $$
\usetikzlibrary{positioning}  %position tikz elements using "right of, etc"
\usetikzlibrary{angles}       %label angles between lines with arcs
\usetikzlibrary{quotes}       %Put angle label in quotes
\usetikzlibrary{patterns}     %Patterns to fill shapes with






  \title{MAE 298 Aeroacoustics -- Homework \#3 \\ Generalized Differentiation and Farassat's Formulation}

\author{
  Logan D. Halstrom \\
  {\normalsize\itshape Graduate Student} \\
  {\normalsize\itshape Department of Mechanical and Aerospace Engineering} \\
  {\normalsize\itshape University of California, Davis, CA 95616}
       }


 % Define commands to assure consistent treatment throughout document
 \newcommand{\eqnref}[1]{(\ref{#1})}
 \newcommand{\class}[1]{\texttt{#1}}
 \newcommand{\package}[1]{\texttt{#1}}
 \newcommand{\file}[1]{\texttt{#1}}
 \newcommand{\BibTeX}{\textsc{Bib}\TeX}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

\maketitle

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \begin{abstract}

% Abstract about homework

% \end{abstract}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Nomenclature}

\begin{multicols}{2}

\begin{tabbing}
  XXX \= \kill% this line sets tab stop
  $0$                 \> Subscript for undisturbed, quiescent parameters \\
  $L$                 \> Subscript for loading parameters \\
  $n$                 \> Surface normal direction \\
  $s$                 \> Surface coordinate variable \\
  $t$                 \> time \\
  $\vec{x}$           \> Observer location vector \\
  $r$                 \> Distance between source and observer \\
  $\hat{r}$           \> Unit vector between source and observer \\
  $\theta$            \> Angle between $\hat{r}$ and $\vec{x}$ \\
  $f$                 \> Function of surfaces within a fluid space \\
  $M$                 \> Mach number \\
  $W(r)$              \> Radial distribution of mean axial velocity \\
  $c$                 \> Speed of Sound\\
  $\overline{\rho}$   \> Mean density \\
  $\gamma$            \> Specific heat ratio \\
  $p$                 \> Pressure  \\
  $\widetilde{p}$     \> Pressure (Discontinuous across data surface)  \\
  $\overline{p}$      \> Mean pressure \\
  $p'$                \> Perturbation pressure \\
  $\Delta P$          \> Pressure difference from CFD solution \\
  $\Phi$              \> Piecewise-continuous variable \\
  $k$                 \> Wavenumber \\
  $\overline{\partial}$ \> Generalized derivative \\
  $\delta$            \> Dirac delta function \\
  \scriptsize{FW-H}   \> Ffowcs Williams-Hawkings\\
  $\omega$            \> Wave oscillating frequency \\
  $i$                 \> Imaginary number $\sqrt{-1}$ \\
  $\exp$              \> Exponential ($e$) \\
  $E$                 \> Exponential term: $kz + n\theta -\omega t$ \\
  $\lambda$           \> Constant term in Bessel equation \\
  $J$                 \> First-order Bessel function \\
  $Y$                 \> Second-order Bessel function \\
  $H^{(n)}$           \> nth-order Hankel function \\
  $x$                 \> Placeholder variable for $\lambda r$ \\
  $A,B$               \> Arbitrary Bessel function constants \\
  $C,D$               \> Arbitrary Hankel constants \\
  $\vec{V}$           \> General velocity vector \\
  $V_r$               \> Velocity component in radial direction \\
  $\nu$               \> Constant velocity parameter \\
  $\chi$              \> Constant position parameter \\
  $\zeta$             \> Position of vortex sheet dividing inner/outer solution \\
  $+/-$               \> Outer/Inner solution, respectively \\





\end{tabbing}

\end{multicols}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Overview} %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In this assignment, we will first derive the wave equation for sound generated by a moving body using generalized differentiation.

Secondly, we will derive Farassat's Formulation 1A of the Ffowcs Williams-Hawkings (FW-H) equation for pressure due to loading noise beginning with Formulation 1



$r=|\vec{x} - \vec{y}|$


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Problem 1 -- Generalized Differentiation of Wave Equation} \label{SecGenDiff}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In this section, we will derive the wave equation for sound generated by a moving body, which is known as the Kirchhoff formula for moving surfaces.  The general acoustic wave equation with no source term (homogeneous) is expressed as follows:

\begin{equation} \label{AcousticWaveHomo}
\boxed{\dfrac{1}{c^2}\dfrac{\partial^2p}{\partial t^2} - \nabla^2p = 0}
\end{equation}

We will used generalized differentiation to show that the wave equation whose sound is generated by an arbitrary moving body $f=0$ can be expressed as follows:

\begin{equation} \label{AcousticWaveBody}
\boxed{\dfrac{1}{c^2}\dfrac{ \overline{\partial}^2\widetilde{p}}{\partial t^2}
    - \overline{\nabla}^2 \widetilde{p}
= -\left[ \dfrac{M_n}{c} \dfrac{\partial p}{\partial t} + p_n \right] \delta(f)
    -\dfrac{1}{c} \dfrac{\partial}{\partial t} \left[ M_n p \delta(f) \right]
    -\nabla \cdot \left[ p \hat{n} \delta(f) \right]}
\end{equation}

\noindent where $\hat{n}$ is the unit normal vector on the surface and $p_n = \nabla p \cdot \hat{n}$.

Now we can use the Green’s function of the wave equation in the unbounded space, the so-called free-space Green’s function, to find the unknown function $p(\vec{x},t)$   everywhere in space. The result is the Kirchhoff formula for moving surfaces.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Data Surface Definition}

To solve for the sound field of a moving surface, we will need to derive a source term to create the inhomogeneous version of Eqn~\ref{AcousticWaveHomo}.  The moving surface will be defined as $f(\vec{x},t) = 0$ and will be referred to as a ``data surface''.  The definition of $f$ allows the fluid to be defined at all points in space, which can be divided into three regions:

\begin{center}
\begin{tabular}{| r  l |}
  \hline
  Data Surface:    & $f=0$ \\
  Exterior Region: & $f>0$ \\
  Interior Region: & $f>0$ \\
  \hline
\end{tabular}
\end{center}

\noindent We will also assume that the gradient of $f$ is the surface outward unit normal vector $\hat{n}$:

\begin{equation} \label{Gradfnormal}
\nabla f = \hat{n}
\end{equation}

Under this definition of $f$, the fluid will exist in all regions of unbounded space and thus enable the usage of Green's function to solve for the sound field.

We will solve for the sound field in the exterior region, but we will assume that the fluid that extends into the interior region has the same conditions as an undisturbed, quiescent medium.  We can define a pressure variable with these properties as $\widetilde{p}$ using the embedding technique as follows:

\begin{equation} \label{Ptilde}
\begin{split}
\boxed{\widetilde{p} =
    \left\{ \begin{array}{lll}
        p, & f > 0 \\
        0, & f < 0
    \end{array} \right.}
\end{split}
\end{equation}

\noindent Thus, pressure will vary outside of the data surface and will be undisturbed inside. Though not continuous, this function of pressure will be defined at all points in an unbounded space and thus applicable to Green's function.




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Generalized Differentiation}

Due to the discontinuity in $\widetilde{p}$ at the data surface $f=0$, we will not be able to use standard differentiation to solve for the sound field and must instead use a technique called generalized differentiation, which will be denoted with a bar over the differential operator (e.g. $\overline{d}, \overline{\partial}, \overline{\nabla}$, etc).

To illustrate the principles of generalized differentiation, we will use the piecewise-continuous pressure $\widetilde{p}$.  The following rules will also apply to other piecewise-continuous fluid properties such as density $\widetilde{\rho}$. Without a formal proof, we can state the rules of generalized differentiation as:

\begin{equation} \label{GenDiff}
\dfrac{\overline{d}\widetilde{p}}{dx}
    = \dfrac{d\widetilde{p}}{dx} + \Delta\widetilde{p} \delta(x - c)
\end{equation}

\noindent where $x$ is an arbitrary variable of differentiation, $\delta$ is the Dirac delta function, $x=c$ is the location of the discontinuity in $\widetilde{p}$, and $\Delta\widetilde{p}=\widetilde{p}(c^+)-\widetilde{p}(c^-)=p - p_0$ is the discontinuous difference in $\widetilde{p}$ at the location of the discontinuity, or the difference in the parameter between the exterior and interior regions of the defined space.

For the case of the arbitrary moving body $f=0$, where $x=f$ and $c=0$, the Dirac delta function $\delta(x-c)$ becomes $\delta(f)$.  Applying Eqn~\ref{GenDiff} to the gradient operator $\nabla$ and using the chain rule, we obtain:

\begin{align*}
\overline{\nabla} \widetilde{p}
&= \dfrac{\overline{\partial}\widetilde{p}}{\partial x_i}
= \dfrac{\overline{\partial}\widetilde{p}}{\partial f}
    \dfrac{\partial f}{\partial x_i} \\
&= \left( \dfrac{\partial\widetilde{p}}{\partial f}
    + \Delta \widetilde{p} \delta(f) \right)
    \dfrac{\partial f}{\partial x_i} \\
&= \dfrac{\partial\widetilde{p}}{\partial f} \dfrac{\partial f}{\partial x_i}
    + \Delta \widetilde{p} \dfrac{\partial f}{\partial x_i} \delta(f) \\
&= \dfrac{\partial\widetilde{p}}{\partial x_i}
    + \dfrac{\partial f}{\partial x_i} \Delta \widetilde{p} \delta(f)
\end{align*}

\noindent Substituting the gradient operator $\nabla = \dfrac{\partial}{\partial x_i}$:

\begin{equation} \label{GenGrad}
\overline{\nabla} \widetilde{p}
= \nabla\widetilde{p} + \nabla f \Delta\widetilde{p} \delta(f)
\end{equation}

Recall the assumption that gradient of $f$ is the outward normal vector, as summarized in Eqn~\ref{Gradfnormal}.  Additionally, we can apply the definition of $\widetilde{p}$ to the pressure difference at the discontinuity $\Delta\widetilde{p} = p - p_0 = p - 0 = p$.  Making these substitutions, we can rewrite Eqn~\ref{GenGrad}:

\begin{equation} \label{GenGradAssume}
\overline{\nabla} \widetilde{p}
= \nabla\widetilde{p} + \hat{n} p \delta(f)
\end{equation}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Kirchhoff Formula Derivation}

We will now apply the principles of generalized differentiation to Eqn~\ref{AcousticWaveHomo} to derive the general equation for the sound field generated by a moving surface.  Beginning with the first term on the LHS of Eqn~\ref{AcousticWaveHomo}:

\begin{align*}
\dfrac{1}{c}\dfrac{\overline{\partial}\widetilde{p}}{\partial t}
&= \dfrac{1}{c}\dfrac{\overline{\partial}\widetilde{p}}{\partial f}
    \dfrac{\partial f}{\partial t} \\
&= \dfrac{1}{c}\left( \dfrac{\partial\widetilde{p}}{\partial f}
    + \Delta \widetilde{p} \delta(f) \right)
    \dfrac{\partial f}{\partial t} \\
&= \dfrac{1}{c}\dfrac{\partial\widetilde{p}}{\partial f} \dfrac{\partial f}{\partial t}
    + p \dfrac{1}{c}\dfrac{\partial f}{\partial t} \delta(f) \\
&= \dfrac{1}{c}\dfrac{\partial\widetilde{p}}{\partial t}
    + p \dfrac{\partial f / \partial t}{c} \delta(f)
\end{align*}

\noindent \color{red} Letting $\dfrac{\partial f}{\partial t} = -V_n$ \color{black}, where $V_n$ is the local normal velocity component along the data surface $f=0$, and recalling that Mach number $M = \dfrac{V}{c}$:

\begin{align*}
\dfrac{1}{c}\dfrac{\overline{\partial}\widetilde{p}}{\partial t}
= \dfrac{1}{c}\dfrac{\partial\widetilde{p}}{\partial t}
    + p \dfrac{-V_n}{c} \delta(f)
\end{align*}

\begin{equation} \label{GenTimeP}
\dfrac{1}{c}\dfrac{\overline{\partial}\widetilde{p}}{\partial t}
= \dfrac{1}{c}\dfrac{\partial\widetilde{p}}{\partial t}
    - M_n p\delta(f)
\end{equation}

Applying the second partial derivative WRT time to the first term of Eqn~\ref{AcousticWaveHomo}:

\begin{align*}
\dfrac{1}{c^2}\dfrac{\overline{\partial}^2\widetilde{p}}{\partial t^2}
    &= \dfrac{1}{c}\dfrac{\overline{\partial}}{\partial t} \left(
    \dfrac{1}{c}\dfrac{\overline{\partial}\widetilde{p}}{\partial t} \right)
= \dfrac{1}{c}\dfrac{\overline{\partial}}{\partial t} \left(
\dfrac{1}{c}\dfrac{\partial\widetilde{p}}{\partial t}
    - M_n p\delta(f) \right)
\end{align*}

\noindent Distributing the differential to the first term and applying the same assumptions and substitutions that were used to derive Eqn~\ref{GenGradAssume}:

\begin{align*}
\dfrac{1}{c}\dfrac{\overline{\partial}}{\partial t}
    \left( \dfrac{1}{c}\dfrac{\partial\widetilde{p}}{\partial t} \right)
    &= \dfrac{1}{c}\dfrac{\overline{\partial}}{\partial f}
    \left( \dfrac{1}{c}\dfrac{\partial\widetilde{p}}{\partial t} \right)
    \dfrac{\partial f}{\partial t} \\
&= \dfrac{1}{c} \left[
    \dfrac{1}{c} \dfrac{\partial}{\partial f} \left(
    \dfrac{\partial\widetilde{p}}{\partial t} \right)
    + \dfrac{1}{c} \dfrac{\partial\Delta\widetilde{p}}{\partial t} \delta(f)
    \right] \dfrac{\partial f}{\partial t} \\
&=  \dfrac{1}{c^2} \dfrac{\partial}{\partial t} \left(
    \dfrac{\partial\widetilde{p}}{\partial t} \right)
    + \dfrac{\partial p}{\partial t} \dfrac{1}{c}\dfrac{-V_n}{c} \delta(f)
\end{align*}

\noindent which results in the final expression for the first term of the second general derivative of pressure WRT time:

\begin{equation} \label{2ndDerTerm1}
\dfrac{1}{c}\dfrac{\overline{\partial}}{\partial t}
    \left( \dfrac{1}{c}\dfrac{\partial\widetilde{p}}{\partial t} \right)
=  \dfrac{1}{c^2} \dfrac{\partial^2\widetilde{p}}{\partial t^2}
    - \dfrac{M_n}{c} \dfrac{\partial p}{\partial t}  \delta(f)
\end{equation}


Now, distributing the differential to the second term, we notice that all three parameters are continuous at the surface $f=0$, thus making the generalized differentiation identical to standard differentiation $\left(\dfrac{\overline{\partial}}{\partial t} = \dfrac{\partial}{\partial t} \right)$

\begin{equation} \label{2ndDerTerm2}
\dfrac{1}{c}\dfrac{\overline{\partial}}{\partial t}\left[-M_n p\delta(f)\right]
    = -\dfrac{1}{c}\dfrac{\partial}{\partial t} \left[ M_n p\delta(f) \right]
\end{equation}

Finally, applying the results for the first (Eqn~\ref{2ndDerTerm1}) and second (Eqn~\ref{2ndDerTerm2}) terms of the second derivative, we derive the final expression:

\begin{equation} \label{2ndDer}
\dfrac{1}{c^2}\dfrac{\overline{\partial}^2\widetilde{p}}{\partial t^2}
= \dfrac{1}{c^2} \dfrac{\partial^2\widetilde{p}}{\partial t^2}
    - \dfrac{M_n}{c} \dfrac{\partial p}{\partial t}  \delta(f)
- \dfrac{1}{c}\dfrac{\partial}{\partial t} \left[ M_n p\delta(f) \right]
\end{equation}


Next, we will solve for the second term on the LHS of Eqn~\ref{AcousticWaveHomo}; the generalized Laplacian of $\widetilde{p}$.  Beginning with the results for a single gradient (Eqn~\ref{GenGradAssume}) and applying the same assumptions and substitutions as used in that derivation:

\begin{align*}
\overline{\nabla}^2 \widetilde{p}
    &= \overline{\nabla} \widetilde{p}
        \left( \overline{\nabla} \widetilde{p} \right)
    = \overline{\nabla}
        \left( \nabla\widetilde{p} + \hat{n} p \delta(f) \right) \\
&= \nabla^2\widetilde{p} + \hat{n}\cdot\nabla p \delta(f)
    + \nabla\cdot \left[ \hat{n} p \delta(f) \right]
\end{align*}

\noindent Letting $p_n = \hat{n}\cdot\nabla p$ be the spatial partial derivative of surface pressure in the outward normal direction of $f=0$, we can write the final form of the generalized Laplacian of pressure:

\begin{equation} \label{DoubleGrad}
\overline{\nabla}^2 \widetilde{p}
    = \nabla^2\widetilde{p} + p_n \delta(f)
    + \nabla\cdot \left[ p\hat{n} \delta(f) \right] \\
\end{equation}

Finally, we will apply generalized differentiation to Eqn~\ref{AcousticWaveHomo}, the homogeneous acoustic wave equation, and then substitute the results for Eqns~\ref{2ndDer} and~\ref{DoubleGrad} to derive the final form of Eqn~\ref{AcousticWaveBody}:

\begin{align*}
\dfrac{1}{c^2}\dfrac{\overline{\partial}^2 \widetilde{p}}{\partial t^2}
    - \overline{\nabla}^2 \widetilde{p}
&= \dfrac{1}{c^2} \dfrac{\partial^2\widetilde{p}}{\partial t^2}
    - \dfrac{M_n}{c} \dfrac{\partial p}{\partial t}  \delta(f)
    - \dfrac{1}{c}\dfrac{\partial}{\partial t} \left[ M_n p\delta(f) \right]
    -\nabla^2\widetilde{p} - p_n \delta(f)
    - \nabla\cdot \left[ p\hat{n} \delta(f) \right] \\
&= \underbrace{\dfrac{1}{c^2} \dfrac{\partial^2\widetilde{p}}{\partial t^2}
    -\nabla^2\widetilde{p}}_{=0}
    - \dfrac{M_n}{c} \dfrac{\partial p}{\partial t}  \delta(f)
    - p_n \delta(f)
    - \dfrac{1}{c}\dfrac{\partial}{\partial t} \left[ M_n p\delta(f) \right]
    - \nabla\cdot \left[ p\hat{n} \delta(f) \right]
\end{align*}

The terms grouped in the bracket are exactly equal to the Right Hand Side (RHS) of Eqn~\ref{AcousticWaveHomo} and are thus exactly equal to zero since this equation is homogeneous.  Grouping like terms in the resulting equation, we derive the final expression for the sound field generated by a moving surface $f=0$, which is equivalent to Kirchoff's formula for moving surfaces:

\begin{equation}
\boxed{\dfrac{1}{c^2}\dfrac{\overline{\partial}^2 \widetilde{p}}{\partial t^2}
    - \overline{\nabla}^2 \widetilde{p}
= -\left[\dfrac{M_n}{c} \dfrac{\partial p}{\partial t} + p_n  \right] \delta(f)
    - \dfrac{1}{c}\dfrac{\partial}{\partial t} \left[ M_n p\delta(f) \right]
    - \nabla\cdot \left[ p\hat{n} \delta(f) \right]}
\end{equation}









%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Problem 2 -- Farassat Formulation 1A for Loading Noise} \label{SecFarassat}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


Farassat’s formulation 1 for the loading noise is given as

\begin{equation} \label{FarassatForm1Loading}
4\pi p_{L}' = \dfrac{1}{c} \dfrac{\partial}{\partial t}
      \int_{f=0} \left[ \dfrac{L_r}{r   (1 - M_r)} \right]_{ret} ds
    + \int_{f=0} \left[ \dfrac{L_r}{r^2 (1 - M_r)} \right]_{ret} ds
\end{equation}


\noindent where $L_r = \Delta P \vec{n} \cdot \hat{r} = \Delta P \cos\theta$. This formulation 1 is difficult to compute since the observer time differentiation is outside the integrals. A much more efficient and practical formulation can be derived by carrying the observer time derivate inside the integrals (formulation 1A). Show that formulation 1A for the loading noise becomes

\begin{equation} \label{FarassatForm1ALoadingEx}
4\pi p_{L}' = \dfrac{1}{c}
      \int_{f=0} \left[ \dfrac{\dot{L}_r}{r (1 - M_r)^2} \right]_{ret} ds
    + \int_{f=0} \left[ \dfrac{L_r - L_M}{r^2 (1 - M_r)} \right]_{ret} ds
+ \dfrac{1}{c} \int_{f=0} \left[
    \dfrac{ L_r[r \dot{M}_r + c(M_r - M^2)] }{r^2 (1 - M_r)^3} \right]_{ret} ds
\end{equation}

\noindent where $L_M = \vec{L} \cdot \vec{M} $.




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Conclusion}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

what you could use moving surface formula for (airfoil)

how you would use formulation 1a in practice with CFD and numerical methods



\end{document}


